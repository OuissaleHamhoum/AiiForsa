title = "gitleaks config"

[[rules]]
    description = "Generic API Key"
    regex = '''(?i)(api[_-]?key|apikey)([\w]*)(=|:|:=|=>|,)[\s]*['|"]?([A-Za-z0-9_]{20,})['|"]?'''
    tags = ["key", "API", "generic"]

[[rules]]
    description = "AWS Access Key ID"
    regex = '''AKIA[0-9A-Z]{16}'''
    tags = ["key", "AWS"]

[[rules]]
    description = "AWS Secret Access Key"
    regex = '''(?i)aws[_-]?secret[_-]?access[_-]?key(=|:=|=>|:)[\s]*['|"]?([A-Za-z0-9/+=]{40})['|"]?'''
    tags = ["key", "AWS"]

[[rules]]
    description = "Google API Key"
    regex = '''AIza[0-9A-Za-z-_]{35}'''
    tags = ["key", "Google"]

[[rules]]
    description = "Slack Token"
    regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''
    tags = ["key", "Slack"]

[[rules]]
    description = "Stripe API Key"
    regex = '''(?i)sk_live_[0-9a-zA-Z]{24}'''
    tags = ["key", "Stripe"]

[[rules]]
    description = "GitHub Personal Access Token"
    regex = '''ghp_[0-9a-zA-Z]{36}'''
    tags = ["key", "GitHub"]

[[rules]]
    description = "Generic Secret"
    regex = '''(?i)(secret|password|token)([\w]*)(=|:|:=|=>|,)[\s]*['|"]?([A-Za-z0-9_!@#$%^&*()+=]{8,})['|"]?'''
    tags = ["key", "generic"]

[allowlist]
    description = "Allowlisted files"
    files = [
        '''^\.?gitleaks\.toml$''',
        '''(.*?)(png|jpg|jpeg|gif|svg|ico|webp|bmp|tiff|pdf|doc|docx|xls|xlsx|ppt|pptx|zip|rar|7z|tar|gz|bz2|exe|dll|so|dylib)$''',
        '''test.*''',
        '''.*\.test\..*''',
        '''.*\.spec\..*''',
        '''.*\.min\..*''',
        '''.*\.lock$''',
        '''.*\.log$''',
        '''node_modules/.*''',
        '''\.git/.*''',
        '''dist/.*''',
        '''build/.*''',
        '''coverage/.*''',
    ]
    commits = [
        '''^WIP:.*''',
        '''^Draft:.*''',
        '''^fixup!.*''',
        '''^squash!.*''',
    ]